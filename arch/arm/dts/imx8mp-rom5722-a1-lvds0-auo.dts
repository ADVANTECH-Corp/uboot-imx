#include "imx8mp-rom5722-a1.dts"

/ {
	aliases {
		video0 = &lcdif2;
	};

	reg_lvds_panel_vbus: reg-lvds-panel-vbus {
		compatible = "regulator-fixed";
		regulator-name = "lvds-panel";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_bklt_vcc>;
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		enable-active-high;
		gpio = <&gpio1 0 GPIO_ACTIVE_HIGH>; /* LCD_BKLT0_EN */
	};

	backlight: backlight {
		compatible = "pwm-backlight";
		pinctrl-names = "default";
		pwms = <&pwm2 0 5000000>;
		status = "okay";
		brightness-levels = < 0  1  2  3  4  5  6  7  8  9
				     10 11 12 13 14 15 16 17 18 19
				     20 21 22 23 24 25 26 27 28 29
				     30 31 32 33 34 35 36 37 38 39
				     40 41 42 43 44 45 46 47 48 49
				     50 51 52 53 54 55 56 57 58 59
				     60 61 62 63 64 65 66 67 68 69
				     70 71 72 73 74 75 76 77 78 79
				     80 81 82 83 84 85 86 87 88 89
				     90 91 92 93 94 95 96 97 98 99
				     100>;
		default-brightness-level = <80>;
	};

	lvds_panel {
		compatible = "simple-panel";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_lvds_panel>;
		enable-gpios = <&gpio1 6 GPIO_ACTIVE_HIGH>; /* LCD_VDD_EN */
		backlight = <&backlight>;
		power-supply = <&reg_lvds_panel_vbus>;
		status = "okay";
		display-timings {
			native-mode = <&timing0>;
			timing0: timing0 {
				clock-frequency = <29500000>;
				hactive = <800>;
				vactive = <480>;
				hfront-porch = <24>;
				hback-porch = <96>;
				hsync-len = <72>;
				vback-porch = <3>;
				vfront-porch = <10>;
				vsync-len = <7>;
			};
		};
		port {
			lvds_in: endpoint {
				remote-endpoint = <&lvds_out>;
			};
		};
	};
};

&pm_domain {
		lvds_phy_pd: lvdsphy-pd {
			compatible = "fsl,imx8m-pm-domain";
			#power-domain-cells = <0>;
			domain-index = <19>;
			domain-name = "lvds_phy";
			parent-domains = <&mediamix_pd>;
		};
};

&aips4 {
	lcdif2: lcd-controller@32e90000 {
		#address-cells = <1>;
		#size-cells = <0>;
		compatible = "fsl,imx8mp-lcdif2";
		reg = <0x32e90000 0x10000>;
		clocks = <&clk IMX8MP_CLK_MEDIA_DISP2_PIX_ROOT>,
			 <&clk IMX8MP_CLK_MEDIA_AXI_ROOT>,
			 <&clk IMX8MP_CLK_MEDIA_APB_ROOT>;
		clock-names = "pix", "disp-axi", "disp-apb";
		assigned-clocks = <&clk IMX8MP_CLK_MEDIA_DISP2_PIX>,
				  <&clk IMX8MP_CLK_MEDIA_AXI>,
				  <&clk IMX8MP_CLK_MEDIA_APB>;
		assigned-clock-parents = <&clk IMX8MP_VIDEO_PLL1_OUT>,
					 <&clk IMX8MP_SYS_PLL2_1000M>,
					 <&clk IMX8MP_SYS_PLL1_800M>;
		assigned-clock-rates = <0>, <500000000>, <200000000>;
		interrupts = <GIC_SPI 6 IRQ_TYPE_LEVEL_HIGH>;
		blk-ctl = <&mediamix_blk_ctl>;
		power-domains = <&mediamix_pd>;
		status = "disabled";

		lcdif2_disp: port@0 {
			#address-cells = <1>;
			#size-cells = <0>;
			reg = <0>;

			lcdif2_disp_ldb_ch0: endpoint@0 {
				reg = <0>;
				remote-endpoint = <&ldb_ch0>;
			};

			lcdif2_disp_ldb_ch1: endpoint@1 {
				reg = <1>;
				remote-endpoint = <&ldb_ch1>;
			};
		};
	};

	ldb: ldb@32ec005c {
		#address-cells = <1>;
		#size-cells = <0>;
		compatible = "fsl,imx8mp-ldb";
		clocks = <&clk IMX8MP_CLK_MEDIA_LDB_ROOT>;
		clock-names = "ldb";
		assigned-clocks = <&clk IMX8MP_CLK_MEDIA_LDB>;
		assigned-clock-parents = <&clk IMX8MP_VIDEO_PLL1_OUT>;
		gpr = <&mediamix_blk_ctl>;
		power-domains = <&mediamix_pd>;
		status = "disabled";

		lvds-channel@0 {
			#address-cells = <1>;
			#size-cells = <0>;
			reg = <0>;
			phys = <&ldb_phy1>;
			phy-names = "ldb_phy";
			status = "disabled";

			port@0 {
				reg = <0>;

				ldb_ch0: endpoint {
					remote-endpoint = <&lcdif2_disp_ldb_ch0>;
				};
			};
		};

		lvds-channel@1 {
			#address-cells = <1>;
			#size-cells = <0>;
			reg = <1>;
			phys = <&ldb_phy2>;
			phy-names = "ldb_phy";
			status = "disabled";

			port@0 {
				reg = <0>;

				ldb_ch1: endpoint {
					remote-endpoint = <&lcdif2_disp_ldb_ch1>;
				};
			};
		};
	};

	ldb_phy: phy@32ec0128 {
		compatible = "fsl,imx8mp-lvds-phy";
		#address-cells = <1>;
		#size-cells = <0>;
		gpr = <&mediamix_blk_ctl>;
		clocks = <&clk IMX8MP_CLK_MEDIA_APB_ROOT>;
		clock-names = "apb";
		power-domains = <&mediamix_pd>;
		status = "disabled";

		ldb_phy1: port@0 {
			reg = <0>;
			#phy-cells = <0>;
		};

		ldb_phy2: port@1 {
			reg = <1>;
			#phy-cells = <0>;
		};
	};
};

&pwm2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm2>;
	status = "okay";
};

&i2c4 {
	clock-frequency = <100000>;
	pinctrl-names = "default", "gpio";
	pinctrl-0 = <&pinctrl_i2c4>;
	pinctrl-1 = <&pinctrl_i2c4_gpio>;
	scl-gpios = <&gpio2 4 GPIO_ACTIVE_HIGH>;
	sda-gpios = <&gpio2 5 GPIO_ACTIVE_HIGH>;
	status = "okay";
};

&lcdif1 {
        status = "disabled";
};

&lcdif2 {
	status = "okay";
};

&ldb {
	status = "okay";
	lvds-channel@0 {
		fsl,data-mapping = "spwg";
		fsl,data-width = <24>;
		status = "okay";
		port@1 {
			reg = <1>;
			lvds_out: endpoint {
				remote-endpoint = <&lvds_in>;
			};
		};
	};
};

&ldb_phy {
	status = "okay";
};

&iomuxc {

	pinctrl_i2c4: i2c4grp {
		fsl,pins = <
			MX8MP_IOMUXC_SD1_DATA2__I2C4_SCL		0x400001c3
			MX8MP_IOMUXC_SD1_DATA3__I2C4_SDA		0x400001c3
		>;
	};

	pinctrl_pwm2: pwm2grp {
		fsl,pins = <
			MX8MP_IOMUXC_SAI5_RXD0__PWM2_OUT		0x116
		>;
	};

	pinctrl_lvds_panel: lvds_panelgrp {
		fsl,pins = <
			MX8MP_IOMUXC_GPIO1_IO06__GPIO1_IO06		0x16
		>;
	};

	pinctrl_bklt_vcc: bklt_vcc_grp {
		fsl,pins = <
			MX8MP_IOMUXC_GPIO1_IO00__GPIO1_IO00		0x16
		>;
	};

	pinctrl_i2c4_gpio: i2c4grp-gpio {
		fsl,pins = <
			MX8MP_IOMUXC_SD1_DATA2__GPIO2_IO04		0x1c3
			MX8MP_IOMUXC_SD1_DATA3__GPIO2_IO05		0x1c3
		>;
	};
};


